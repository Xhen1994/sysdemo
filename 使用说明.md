# 协同数字化平台 - 完整使用说明

## 📋 目录

1. [系统简介](#系统简介)
2. [快速安装](#快速安装)
3. [功能说明](#功能说明)
4. [角色权限](#角色权限)
5. [常见问题](#常见问题)
6. [注意事项](#注意事项)

---

## 系统简介

协同数字化平台是一个面向省级单位的协同办公系统，提供目标管理、问题反馈、工作流管理、知识库和数据看板等功能。

**系统特点**:
- 🎯 完整的目标管理体系
- 🤖 AI智能分析（DeepSeek）
- 📊 可视化数据看板
- 📚 Markdown知识库
- 🔐 基于角色的权限控制
- 💾 本地文件存储，无需数据库

---

## 快速安装

### 方法一：在服务器上部署（推荐）

#### 1. 连接到服务器
```bash
ssh xhen@14.103.165.46
```

#### 2. 进入项目目录
```bash
cd /home/xhen/myprojects/sysdemo
```

#### 3. 创建Python环境
```bash
# 使用conda创建环境
conda create -n sysdemo python=3.11 -y
conda activate sysdemo

# 安装依赖
pip install -r requirements.txt
```

#### 4. 配置环境变量（可选）
```bash
# 复制环境变量示例
cp env.example .env

# 编辑环境变量
nano .env
```

**重要配置**:
- `SECRET_KEY`: 生产环境必须修改
- `DEEPSEEK_API_KEY`: 使用AI功能需要配置

#### 5. 启动应用
```bash
# 赋予脚本执行权限
chmod +x start.sh stop.sh restart.sh

# 启动应用
./start.sh
```

#### 6. 访问系统
打开浏览器访问：`http://14.103.165.46:4000`

**默认账号**:
- 用户名: `admin`
- 密码: `admin123`

⚠️ **首次登录后请立即修改密码！**

### 方法二：本地开发测试

```bash
# 1. 克隆或下载项目到本地
cd /path/to/sysdemo

# 2. 创建虚拟环境（可选）
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或
venv\Scripts\activate  # Windows

# 3. 安装依赖
pip install -r requirements.txt

# 4. 直接运行
python app.py

# 5. 访问
# 打开浏览器访问 http://localhost:4000
```

---

## 功能说明

### 1️⃣ 工作台（Dashboard）

**路径**: `/dashboard`

**功能**:
- 📊 整体数据统计展示
- 📈 目标完成率图表
- 📉 问题类别分布
- 📊 任务分布统计

**适用角色**: 所有用户

---

### 2️⃣ 目标管理

**路径**: `/objectives`

#### 2.1 查看目标
- 查看所有分配给自己的目标
- 查看目标进度和状态
- 查看子目标

#### 2.2 创建目标（管理员）
1. 点击"创建目标"
2. 填写目标信息：
   - **标题**: 目标名称
   - **描述**: 详细说明
   - **目标省份**: 选择目标省份
   - **负责人**: 指定负责人
   - **截止日期**: 设置deadline
   - **父目标**: 可选，创建子目标
3. 点击"创建目标"

#### 2.3 更新进度
1. 进入目标详情
2. 点击"更新进度"
3. 拖动进度条设置百分比
4. 选择状态：
   - 待开始 (pending)
   - 进行中 (in_progress)
   - 已完成 (completed)
5. 保存

#### 2.4 审核目标（管理员）
1. 进入目标详情
2. 点击"审核目标"
3. 选择审核结果（通过/不通过）
4. 填写审核意见
5. 提交

**目标状态说明**:
- 🔵 **pending**: 待开始
- 🟡 **in_progress**: 进行中
- 🟢 **completed**: 已完成
- 🔴 **overdue**: 已逾期

---

### 3️⃣ 问题反馈

**路径**: `/issues`

#### 3.1 提交问题
1. 点击"提交问题"
2. 填写问题信息：
   - **标题**: 简明扼要的问题描述
   - **描述**: 详细的问题说明
   - **类别**: 选择问题类型
     - bug: 系统缺陷
     - feature: 新功能需求
     - improvement: 改进建议
     - question: 使用问题
   - **优先级**: 设置紧急程度
     - low: 低
     - medium: 中
     - high: 高
     - urgent: 紧急
3. 提交

#### 3.2 处理问题（管理员）
1. 查看问题列表
2. 进入问题详情
3. 可进行操作：
   - **分配**: 指派处理人员
   - **更新状态**: 
     - open → assigned → in_progress → resolved → closed
   - **添加评论**: 讨论和反馈

#### 3.3 AI智能总结（管理员）
1. 在问题列表页点击"AI总结"
2. 选择过滤条件：
   - 省份
   - 类别
   - 状态
3. 点击"生成总结"
4. 等待AI分析完成
5. 查看总结结果

**注意**: 需要配置DEEPSEEK_API_KEY才能使用

---

### 4️⃣ 工作流管理

**路径**: `/tasks`

#### 4.1 创建任务（管理员）
1. 点击"创建任务"
2. 填写任务信息：
   - **标题**: 任务名称
   - **描述**: 详细说明
   - **类型**: 
     - support: 技术支撑
     - maintenance: 系统维护
     - deployment: 部署
     - other: 其他
   - **优先级**: low/medium/high/urgent
   - **省份**: 目标省份
   - **指派给**: 执行人（留空自动分配）
3. 创建

#### 4.2 执行任务
1. 查看分配给自己的任务
2. 进入任务详情
3. 添加工作日志：
   - 记录工作内容
   - 遇到的问题
   - 解决方案
4. 更新任务状态：
   - pending → assigned → in_progress → completed → verified

#### 4.3 任务验收（管理员）
1. 进入已完成的任务
2. 查看工作日志
3. 更新状态为"已验收"(verified)

---

### 5️⃣ 知识库

**路径**: `/knowledge`

#### 5.1 创建知识
1. 点击"创建知识"
2. 填写信息：
   - **标题**: 知识文档标题
   - **内容**: 支持Markdown格式
   - **分类**: 如"技术文档"、"使用指南"
   - **标签**: 多个标签用逗号分隔
3. 创建

#### 5.2 Markdown语法示例
```markdown
# 一级标题
## 二级标题

**粗体** *斜体*

- 列表项1
- 列表项2

1. 有序列表1
2. 有序列表2

`代码片段`

​```python
# 代码块
print("Hello World")
​```

> 引用文本
```

#### 5.3 搜索知识
1. 在搜索框输入关键词
2. 选择分类（可选）
3. 点击搜索

#### 5.4 编辑知识
- 作者和管理员可以编辑自己创建的知识
- 点击"编辑"按钮修改内容

---

### 6️⃣ 系统管理（仅管理员）

**路径**: `/admin`

#### 6.1 用户管理
- **创建用户**: 添加新用户
- **编辑用户**: 修改用户信息、角色、状态
- **删除用户**: 删除用户账号
- **重置密码**: 为用户重置密码

#### 6.2 系统日志
- 查看所有系统操作记录
- 审计用户行为
- 追踪系统变更

#### 6.3 系统设置
- 配置DeepSeek API密钥
- 设置系统参数
- 通知配置

---

## 角色权限

### 🔴 系统管理员 (admin)
**权限**: 拥有所有权限

**可以做什么**:
- ✅ 管理所有用户
- ✅ 创建和审核所有目标
- ✅ 处理所有问题
- ✅ 分配和验收任务
- ✅ 管理知识库
- ✅ 查看系统日志
- ✅ 使用AI功能
- ✅ 配置系统参数

### 🟡 省级管理员 (province_manager)
**权限**: 管理本省事务

**可以做什么**:
- ✅ 查看和管理本省目标
- ✅ 创建和审核本省目标
- ✅ 处理本省问题
- ✅ 创建和分配本省任务
- ✅ 使用AI功能
- ✅ 管理知识库
- ❌ 不能管理其他省份
- ❌ 不能访问系统管理

### 🟢 普通员工 (staff)
**权限**: 处理自己的工作

**可以做什么**:
- ✅ 查看和更新自己的目标
- ✅ 提交问题反馈
- ✅ 执行分配的任务
- ✅ 记录工作日志
- ✅ 访问知识库
- ❌ 不能创建目标
- ❌ 不能分配任务
- ❌ 不能使用AI功能
- ❌ 不能访问系统管理

---

## 常见问题

### Q1: 忘记密码怎么办？
**A**: 联系系统管理员重置密码。管理员可以在"系统管理" > "用户管理"中为用户重置密码（默认重置为123456）。

### Q2: 如何修改自己的密码？
**A**: 暂不支持用户自助修改密码，请联系管理员。
（开发建议：可在base.html中添加修改密码功能）

### Q3: AI功能无法使用？
**A**: 
1. 确认管理员已配置DEEPSEEK_API_KEY
2. 检查网络连接
3. 查看系统日志获取错误信息

### Q4: 如何创建子目标？
**A**: 在创建目标时，选择"父目标"字段，选择一个已存在的目标作为父目标。

### Q5: 任务可以自动分配吗？
**A**: 可以。在创建任务时，如果不指定执行人，系统会自动分配给目标省份的第一个员工。

### Q6: 知识库支持图片吗？
**A**: 支持。在Markdown中使用 `![描述](图片URL)` 语法。

### Q7: 如何导出数据？
**A**: 所有数据存储在服务器的data目录下，管理员可以直接下载相应的JSON/JSONL文件。

### Q8: 系统支持多少用户？
**A**: 理论上无限制，但建议100人以内使用。更大规模建议迁移到数据库。

### Q9: 如何备份数据？
**A**: 
```bash
cd /home/xhen/myprojects/sysdemo
tar -czf backup-$(date +%Y%m%d).tar.gz data/
```

### Q10: 应用崩溃了怎么办？
**A**: 
```bash
# 查看日志
tail -f logs/app.log

# 重启应用
./restart.sh
```

---

## 注意事项

### 🔒 安全建议

1. **修改默认密码**: 首次登录后立即修改admin账号密码
2. **定期备份**: 建议每天自动备份data目录
3. **限制访问**: 配置防火墙，限制4000端口的访问来源
4. **更新依赖**: 定期更新Python依赖包
5. **审查日志**: 定期查看系统日志，发现异常及时处理

### ⚡ 性能建议

1. **数据清理**: 定期清理过期的日志数据
2. **文件大小**: JSONL文件过大时考虑归档
3. **并发访问**: 如并发访问量大，建议使用Gunicorn
4. **静态资源**: 使用Nginx托管静态文件

### 📝 使用建议

1. **及时更新**: 及时更新目标和任务进度
2. **详细记录**: 工作日志要详细记录，便于追溯
3. **合理分类**: 问题和知识要合理分类，便于查找
4. **善用标签**: 知识库中多使用标签，提高可查找性
5. **AI辅助**: 善用AI功能进行问题分析和总结

### 🔧 维护建议

1. **监控服务**: 设置监控脚本，确保服务正常运行
2. **日志轮转**: 配置日志轮转，防止日志文件过大
3. **定期重启**: 建议每周重启一次应用
4. **更新文档**: 功能变更时及时更新文档

---

## 📞 技术支持

如遇到问题：
1. 查看本文档的"常见问题"部分
2. 查看系统日志：`tail -f logs/app.log`
3. 在系统中提交问题反馈
4. 联系系统管理员

---

## 📚 相关文档

- `README.md` - 项目说明
- `部署指南.md` - 详细部署步骤
- `快速开始.md` - 快速入门
- `项目概览.md` - 技术架构

---

## 🎉 开始使用

现在可以访问系统开始使用了：

👉 **http://14.103.165.46:4000**

默认账号: `admin` / `admin123`

祝您使用愉快！ 🚀

---

**文档版本**: 1.0  
**最后更新**: 2025年10月16日

